# synthetic-uv
This repo contains the script to generate synthetic visibility (Fourier domain) from DSA-2000 simulated gravitational lensing image data generated by [POLISH (Connor et al. 2022)](https://github.com/liamconnor/polish-pub/tree/main).
---

# Get started

## Step 1: Generate POLISH data

First, generate the data to using [`make_img_pairs.py` provided by POLISH](https://github.com/liamconnor/polish-pub/blob/main/make_img_pairs.py) with the root directory of this repo to be the output.

```
python make_img_pairs.py -o /path/to/this/repo/ -k psf/dsa-2000-fullband-psf.fits -s 512
```

It should then create the following subdirectories in the repo root directory:

- `POLISH_train_HR`: True sky image (noise-free, full resolution) for training set.
- `POLISH_train_HR_Noise`: `POLISH_train_HR` but with noise. Used to generated `observed visibility` that includes `n_sky`.
- `POLISH_valid_HR`: True sky image (noise-free, full resolution) for validation set.
- `POLISH_valid_HR_Noise`: `POLISH_valid_HR` but with noise. Used to generated `observed visibility` that includes `n_sky`.
- `POLISH_train_LR_bicubic`: Low-resolution dirty images used for POLISH training input. This is unused for our purposes.
- `POLISH_valid_LR_bicubic`: Low-resolution dirty images used for POLISH validation input. This is unused for our purposes.
- `psf`: Stores the ideal PSF. This is unused for our purposes.

## Step 2: Download pre-generated `synthetic_data` (Alternatively: You can generate your own using the provided `data_processing.ipynb`. WARNING: Will take a long time (6 hrs) and ~100TB of space!)

Download the pre-generated `synthetic_data` directory (LINK TBD) and extract to the root directory of this repo. It should have the following structure:

```
synthetic_data/
├── train/
│   ├── freq_10MHz/
│   │   ├── antennas_16_s1/
│   │   └── ...
│   └── ...
├── valid/
│   ├── freq_10MHz/
│   │   ├── antennas_16_s1/
│   │   └── ...
│   └── ...
```

Further documentation for `synthetic_data` can be seen here (LINK TBD).

## Step 3: Done!

The directory structure of this repo can be seen below:
```
.
├── data_processing.ipynb
├── POLISH_train_HR
│   ├── 0000.npy
│   ├── ...
│   └── 0799.npy
├── POLISH_train_HR_Noise
│   ├── 0000_noise.npy
│   ├── ...
│   └── 0799_noise.npy
├── POLISH_train_LR_bicubic
│   └── X2
├── POLISH_valid_HR
│   ├── 0800.npy
│   ├── ...
│   └── 0899.npy
├── POLISH_valid_HR_Noise
│   ├── 0800_noise.npy
│   ├── ...
│   └── 0899_noise.npy
├── POLISH_valid_LR_bicubic
│   └── X2
├── psf
│   └── psf_ideal.npy
├── synthetic_data
│   ├── train
│   ├── uv
│   └── valid
```
